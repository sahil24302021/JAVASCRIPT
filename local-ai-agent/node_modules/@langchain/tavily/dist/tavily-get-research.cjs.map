{"version":3,"file":"tavily-get-research.cjs","names":["z","StructuredTool","params: TavilyGetResearchAPIRetrieverFields","apiWrapperParams: { tavilyApiKey?: string; apiBaseUrl?: string }","TavilyResearchAPIWrapper","input: InferInteropZodOutput<typeof inputSchema>","_runManager?: CallbackManagerForToolRun","result:\n        | TavilyGetResearchResponse\n        | TavilyGetIncompleteResearchResponse","e: unknown"],"sources":["../src/tavily-get-research.ts"],"sourcesContent":["import { CallbackManagerForToolRun } from \"@langchain/core/callbacks/manager\";\nimport { StructuredTool, ToolParams } from \"@langchain/core/tools\";\nimport { z } from \"zod/v3\";\nimport { InferInteropZodOutput } from \"@langchain/core/utils/types\";\nimport {\n  TavilyResearchAPIWrapper,\n  type TavilyGetIncompleteResearchResponse,\n  type TavilyGetResearchResponse,\n} from \"./utils.js\";\n\nexport type TavilyGetResearchAPIRetrieverFields = ToolParams & {\n  /**\n   * The base URL to be used for the Tavily Research API.\n   */\n  apiBaseUrl?: string;\n\n  /**\n   * The API key used for authentication with the Tavily Research API.\n   */\n  tavilyApiKey?: string;\n\n  /**\n   * The name of the tool.\n   *\n   * @default \"tavily_get_research\"\n   */\n  name?: string;\n\n  /**\n   * The description of the tool.\n   *\n   * @default \"Retrieves the results of a research task by its request_id. Use this tool after creating a research task to get the completed research report, including the content, sources, and status. Input should be a request_id from a previously created research task.\"\n   */\n  description?: string;\n\n  /**\n   * Whether to return the tool's output directly.\n   *\n   * Setting this to true means that after the tool is called,\n   * an agent should stop looping.\n   *\n   * @default false\n   */\n  returnDirect?: boolean;\n\n  /**\n   * An API wrapper that can be used to interact with the Tavily Research API. Useful for testing.\n   *\n   * If specified, the tool will use this API wrapper instead of creating a new one, and fields used\n   * in API Wrapper initialization, like {@link TavilyGetResearchAPIRetrieverFields.tavilyApiKey}, will be\n   * ignored.\n   */\n  apiWrapper?: TavilyResearchAPIWrapper;\n};\n\nconst inputSchema = z.object({\n  requestId: z.string().describe(\"The unique identifier of the research task.\"),\n});\n\n/**\n * A Tool for retrieving research results by request_id from the Tavily Research API.\n * Extends the StructuredTool class and allows you to check the status and retrieve\n * results of a research task that was previously created.\n *\n * Authentication is handled via an API key, which can be passed during\n * instantiation or set as an environment variable `TAVILY_API_KEY`.\n *\n * Example:\n * ```typescript\n * const tool = new TavilyGetResearch({\n *   tavilyApiKey: \"YOUR_API_KEY\"\n * });\n * const results = await tool.invoke({\n *   requestId: \"abc123-def456-ghi789\"\n * });\n * console.log(results);\n * ```\n */\nexport class TavilyGetResearch extends StructuredTool<typeof inputSchema> {\n  static lc_name(): string {\n    return \"TavilyGetResearch\";\n  }\n\n  override description: string =\n    \"Retrieves the results of a research task by its request_id. \" +\n    \"Use this tool after creating a research task to get the completed research report, \" +\n    \"including the content, sources, and status. Input should be a request_id from a \" +\n    \"previously created research task.\";\n\n  override name: string = \"tavily_get_research\";\n\n  override schema = inputSchema;\n\n  apiBaseUrl?: string;\n\n  private apiWrapper: TavilyResearchAPIWrapper;\n\n  constructor(params: TavilyGetResearchAPIRetrieverFields = {}) {\n    super(params);\n\n    if (typeof params.name === \"string\") {\n      this.name = params.name;\n    }\n\n    if (typeof params.description === \"string\") {\n      this.description = params.description;\n    }\n\n    if (params.apiWrapper) {\n      this.apiWrapper = params.apiWrapper;\n    } else {\n      const apiWrapperParams: { tavilyApiKey?: string; apiBaseUrl?: string } =\n        {};\n      if (params.tavilyApiKey) {\n        apiWrapperParams.tavilyApiKey = params.tavilyApiKey;\n      }\n      if (params.apiBaseUrl) {\n        apiWrapperParams.apiBaseUrl = params.apiBaseUrl;\n      }\n      this.apiWrapper = new TavilyResearchAPIWrapper(apiWrapperParams);\n    }\n  }\n\n  async _call(\n    input: InferInteropZodOutput<typeof inputSchema>,\n    _runManager?: CallbackManagerForToolRun\n  ): Promise<\n    | TavilyGetResearchResponse\n    | TavilyGetIncompleteResearchResponse\n    | { error: string }\n  > {\n    try {\n      const { requestId } = input;\n\n      const result:\n        | TavilyGetResearchResponse\n        | TavilyGetIncompleteResearchResponse =\n        await this.apiWrapper.getResearch(requestId);\n\n      if (\n        !result ||\n        typeof result !== \"object\" ||\n        !(\"request_id\" in result) ||\n        !(\"status\" in result)\n      ) {\n        const errorMessage =\n          `Invalid research response for request_id '${requestId}'. ` +\n          `Please verify the request_id is correct.`;\n\n        throw new Error(errorMessage);\n      }\n\n      return result;\n    } catch (e: unknown) {\n      const errorMessage =\n        e && typeof e === \"object\" && \"message\" in e ? e.message : String(e);\n      return { error: errorMessage as string };\n    }\n  }\n}\n"],"mappings":";;;;;;AAuDA,MAAM,cAAcA,SAAE,OAAO,EAC3B,WAAWA,SAAE,QAAQ,CAAC,SAAS,8CAA8C,CAC9E,EAAC;;;;;;;;;;;;;;;;;;;;AAqBF,IAAa,oBAAb,cAAuCC,sCAAmC;CACxE,OAAO,UAAkB;AACvB,SAAO;CACR;CAED,AAAS,cACP;CAKF,AAAS,OAAe;CAExB,AAAS,SAAS;CAElB;CAEA,AAAQ;CAER,YAAYC,SAA8C,CAAE,GAAE;EAC5D,MAAM,OAAO;AAEb,MAAI,OAAO,OAAO,SAAS,UACzB,KAAK,OAAO,OAAO;AAGrB,MAAI,OAAO,OAAO,gBAAgB,UAChC,KAAK,cAAc,OAAO;AAG5B,MAAI,OAAO,YACT,KAAK,aAAa,OAAO;OACpB;GACL,MAAMC,mBACJ,CAAE;AACJ,OAAI,OAAO,cACT,iBAAiB,eAAe,OAAO;AAEzC,OAAI,OAAO,YACT,iBAAiB,aAAa,OAAO;GAEvC,KAAK,aAAa,IAAIC,uCAAyB;EAChD;CACF;CAED,MAAM,MACJC,OACAC,aAKA;AACA,MAAI;GACF,MAAM,EAAE,WAAW,GAAG;GAEtB,MAAMC,SAGJ,MAAM,KAAK,WAAW,YAAY,UAAU;AAE9C,OACE,CAAC,UACD,OAAO,WAAW,YAClB,EAAE,gBAAgB,WAClB,EAAE,YAAY,SACd;IACA,MAAM,eACJ,CAAC,0CAA0C,EAAE,UAAU,2CAAG,CAChB;AAE5C,UAAM,IAAI,MAAM;GACjB;AAED,UAAO;EACR,SAAQC,GAAY;GACnB,MAAM,eACJ,KAAK,OAAO,MAAM,YAAY,aAAa,IAAI,EAAE,UAAU,OAAO,EAAE;AACtE,UAAO,EAAE,OAAO,aAAwB;EACzC;CACF;AACF"}